<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lode Runner par Caroline Boudreau et Émil Dallaire</title>
    <link rel="stylesheet" type="text/css" href="" />
    <script src="niveau.js" type="text/javascript"></script>
    <script src="pointage.js" type="text/javascript"></script>
    <script src="initialisations.js" type="text/javascript"></script>
    <!-- Code JavaScript local -->
    <script type="text/javascript">
        let objCanvas = null;
        let objC2D = null;
        let objCycleAnimation = null;

        let objPointage = null;
        let objSons = null;
        let tabObjMurs = null;
        let objNiveau = null;
        let objLodeRunner = null;
        let tabObjGardes = null;

        const initAnimation = () => {
            objCanvas = document.getElementById("monCanvas");
            objCanvas.focus();
            objC2D = objCanvas.getContext("2d");

            //Initialiser les objets
            initObjNiveau();
            initPointage();
            initObjLodeRunner();
            dessiner(); // dessiner une première fois
            animer();

        }

        function effacerDessin() {
            objC2D.clearRect(0, 0, objCanvas.width, objCanvas.height);
        }

        function mettreAjourAnimation() {
            mettreAJourTemps();

        }

        // Un cycle d'animation	
        function animer() {
            // Requête pour le prochain cycle
            objCycleAnimation = requestAnimationFrame(animer);

            // Le cycle d'animation
            effacerDessin();
            mettreAjourAnimation();
            dessiner();
        }

        function arreterAnimation() {
            if (objCycleAnimation != null)
                cancelAnimationFrame(objCycleAnimation);
            objCycleAnimation = null;
        }

        function dessiner() {
            dessinerContour();
            dessinerNiveau();
            dessinerPointage();
            dessinerLodeRunner();
        }
        /*
        Je ne savais pas où mettre la fonction qui dessine Lode Runner. 
        Ce dessin peut se situer ailleurs notre programme si tu le souhaite!
        N'hésite pas changer de place cete fonction.
        Aussi, le dessin de Lode Runner peut être complètement différent.
        */
        function dessinerLodeRunner() {
            objC2D.save();

            objC2D.fillStyle = '#a09794';
            objC2D.translate(objLodeRunner.posX, objLodeRunner.posY);

            objC2D.beginPath();
            objC2D.arc(6,5, 4, 0,2*Math.PI);
            objC2D.fill();

            objC2D.beginPath();
            objC2D.fillRect(4.5,5,3,18);


            objC2D.beginPath();
            objC2D.fillRect(-3, 12,20,2);

            objC2D.beginPath();
            objC2D.rotate(Math.PI/8);
            objC2D.fillRect(12, 17,3,10);
            objC2D.rotate(-2*Math.PI/8);

            objC2D.fillRect(-4, 23,3,10);
            objC2D.restore();
        }

    </script>

</head>

<body onload="initAnimation()">
    <canvas id="monCanvas" width="940" height="710" tabIndex="1">
        Votre navigateur ne supporte pas la balise canvas
    </canvas>
</body>

</html>